<!DOCTYPE HTML>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0"/>
<meta name="apple-mobile-web-app-capable" content="yes"/>
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="images/splash/splash-icon.png">
<link rel="apple-touch-startup-image" href="images/splash/splash-screen.png" 			media="screen and (max-device-width: 320px)" />  
<link rel="apple-touch-startup-image" href="images/splash/splash-screen_402x.png" 		media="(max-device-width: 480px) and (-webkit-min-device-pixel-ratio: 2)" /> 
<link rel="apple-touch-startup-image" sizes="640x1096" href="images/splash/splash-screen_403x.png" />
<link rel="apple-touch-startup-image" sizes="1024x748" href="images/splash/splash-screen-ipad-landscape" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : landscape)" />
<link rel="apple-touch-startup-image" sizes="768x1004" href="images/splash/splash-screen-ipad-portrait.png" media="screen and (min-device-width : 481px) and (max-device-width : 1024px) and (orientation : portrait)" />
<link rel="apple-touch-startup-image" sizes="1536x2008" href="images/splash/splash-screen-ipad-portrait-retina.png"   media="(device-width: 768px)	and (orientation: portrait)	and (-webkit-device-pixel-ratio: 2)"/>
<link rel="apple-touch-startup-image" sizes="1496x2048" href="images/splash/splash-screen-ipad-landscape-retina.png"   media="(device-width: 768px)	and (orientation: landscape)	and (-webkit-device-pixel-ratio: 2)"/>
<title>家庭影院</title>
<link href="styles/style.css" rel="stylesheet" type="text/css">
<link href="styles/framework.css" rel="stylesheet" type="text/css">
<link href="styles/owl.carousel.css" rel="stylesheet" type="text/css">
<link href="styles/owl.theme.css" rel="stylesheet" type="text/css">
<link href="styles/swipebox.css" rel="stylesheet" type="text/css">
<link href="styles/colorbox.css" rel="stylesheet" type="text/css">
<link href="styles/amazeui.min.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="scripts/jquery.js"></script>
<script type="text/javascript" src="scripts/jqueryui.js"></script>
<script type="text/javascript" src="scripts/owl.carousel.min.js"></script>
<script type="text/javascript" src="scripts/jquery.swipebox.js"></script>
<script type="text/javascript" src="scripts/jquery.colorbox-min.js"></script>
<script type="text/javascript" src="scripts/snap.js"></script>
<script type="text/javascript" src="scripts/contact.js"></script>
<script type="text/javascript" src="scripts/custom.js"></script>
<script type="text/javascript" src="scripts/framework.js"></script>
<script type="text/javascript" src="scripts/framework.launcher.js"></script>
<script type="text/javascript" src="scripts/amazeui.min.js"></script>
<script type="text/javascript" src="scripts/handlebars.min.js"></script>
<script type="text/javascript" src="scripts/amazeui.widgets.helper.js"></script>

</head>
<body>

<div id="preloader">
    <div id="status">
        <p class="center-text">
            加载页面中...
            <em>页面加载中,请稍候...</em>
        </p>
    </div>
</div>
</div>

<div class="top-deco"></div>

<div class="content">
	<div class="header">
            <a href="#" style="padding: 15px">
                <button style="height: 200"></button>
            </a>
            <a href="/" class="go-home">首页</a>
            <a href="#" class="go-menu">菜单</a>
            <a href="#" class="go-back">关闭</a>
            <a href="logout" class="go-out">退出</a>
        </div>
    <div class="decoration"></div>
    
    <div class="navigation">
    	<div class="corner-deco"></div>
    	<div class="navigation-wrapper">
            <div class="navigation-item">
                <a href="/">首页</a>
                <em class="active-menu"></em>
            </div>
            <div class="navigation-item">
                <a href="camera">查看监控</a>
                <em class="active-menu"></em>
            </div>
            <div class="navigation-item">
                <a href="download">离线下载</a>
                <em class="active-menu"></em>
            </div>
            <div class="navigation-item">
                <a href="storage">云存储</a>
                <em class="active-menu"></em>
            </div>
            <div class="navigation-item">
                <a href="music">音乐</a>
                <em class="active-menu"></em>
            </div>
            <div class="navigation-item">
                <a href="setting">设定</a>
                <em class="activen-menu"></em>
            </div>
        </div>
    </div>
</div>

<div class="content">
  <div class="display">
  <script type="text/x-handlebars-template" id="move-tp">
    {{>gallery move}}
  </script>
</div>
  <ul data-am-widget="pagination" class="am-pagination am-pagination-select pageSelect" nowPage="0">
      <li class="am-pagination-prev ">
        <a href="#" class="pageButton" classification="-1">上一页</a>
      </li>
      <li class="am-pagination-next ">
        <a href="#" class="pageButton" classification="1">下一页</a>
      </li>
  </ul>
	<div class="decoration"></div>            
    <div class="footer">
        <div class="clear"></div>
        <p class="copyright">
            COPYRIGHT 2015.<br>
            ALL RIGHTS RESERVED
        </p>
    </div> 
</div>
<div class="bottom-deco"></div>
<script type="text/javascript">
  $(function(){
    var $tpl = $("#move-tp");
    tpl = $tpl.text();
    template = Handlebars.compile(tpl);
    var Hdata = {
          move:{
            // id
              "id": "",
              // 自定义 class
              "className": "",
              // 主题
              "theme": "",
              "options": {
                "cols": 3,  // 列数
                "gallery": false // 是否开启点击图片全屏显示大图功能
              },
              //内容（*为必备项）
              "content": [
                {
                  "img": "http://www.imageto.org/images/Jbc9T.jpg", // *
                  "link": "", // 链接
                  "title": "11111", // *图片标题
                  "className": "", // 仅在设置了 link 后有效
                  "desc": "" // 附加信息，支持DOM，为高级定制提供DOM接口
                }
              ]
          }
    }
    function queryMoveList(pageNumber){
      $.ajax({
        url:"http://localhost:3000/data/move",
        dataType:"json",
        type:"post",
        data:{
          page:pageNumber,
          pageSize:10,
          condition:{}
        },
        success:function(data){
          var content = [];
          if(data == null){
            return;
          }
          for(var i = 0;i < data.length;i++){
            try{
              var obj = data[i];
              content.push({"img":obj['titleImage'],"title":obj['moveName'],"desc":'<p title="'+obj['summary']+'">'+cut(obj['summary'])+'...</p>'})
            }catch(err){
              console.log("解析电影失败"+err);
            }
          }
          Hdata.move['content'] = content;
          html = template(Hdata);
          $("div.display").html(html);
        }
      })
    }
    function refrashPage(classification){
      var nowPage = parseInt($("ul.pageSelect").attr("nowPage"));
      queryMoveList(nowPage + classification);
      $("ul.pageSelect").attr("nowPage",nowPage + classification);
    }
    function initButton(){
        $("a.pageButton").each(function(){
          $(this).click(function(){
            var classification = parseInt($(this).attr("classification"))
            refrashPage(classification);
          })
        })
    }
    var cut = function(string,lenngth){
      return string.substring(0,length?length:100)
    }

    function init(){
      refrashPage(1);
      initButton();
    }
    init();
  })
</script>
</body>
</html>